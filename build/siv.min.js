/*
 * The MIT License
 *
 * (MIT)Copyright (c) 2015 artjomb
 */
!function(t){var r;r=t.hasOwnProperty("ext")?t.ext:t.ext={};{var e=(t.lib.Base,t.lib.WordArray);t.algo.AES}r.const_Zero=e.create([0,0,0,0]),r.const_One=e.create([0,0,0,1]),r.const_Rb=e.create([0,0,0,135]),r.const_nonMSB=e.create([4294967295,4294967295,2147483647,2147483647]),r.isWordArray=function(t){return t&&"function"==typeof t.clamp&&"function"==typeof t.concat&&"array"==typeof t.words},t.pad.OneZeroPadding={pad:function(t,r){for(var s=4*r,i=s-t.sigBytes%s,n=[],o=0;i>o;o+=4){var a=0;0===o&&(a=2147483648),n.push(a)}var c=e.create(n,i);t.concat(c)},unpad:function(){}},t.pad.NoPadding={pad:function(){},unpad:function(){}},r.bitshift=function(t,r){if(r>0){for(var e,s=0,i=t.words.length-1;i>=0;i--)e=t.words[i],t.words[i]<<=r,t.words[i]|=s,s=e>>>32-r;return s}return t},r.leftmostWords=function(t,r){var e=t.clone();return e.sigBytes=4*r,e.clamp(),e},r.leftmostBytes=function(t,r){var e=t.clone();return e.sigBytes=r,e.clamp(),e},r.rightmostWords=function(t,r){return t.clamp(),e.create(t.words.slice(-r))},r.rightmostBytes=function(t,e){t.clamp();var s=32,i=t.clone(),n=8*e;if(n>=s){var o=Math.floor(n/s);n-=o*s,i.words=i.words.splice(0,o),i.sigBytes-=o*s/8}return n>0&&(r.bitshift(i,n),i.sigBytes-=n/8),i},r.popWords=function(t,e){var s=r.leftmostWords(t,e);return t.words=t.words.slice(-e),t.sigBytes-=4*e,s},r.shift=function(t,r){r=r||16;for(var s=[],i=0;r>i;i+=4)s.push(t.words.shift()),t.sigBytes-=4;return e.create(s)},r.shiftBytes=function(t,s){s=s||16;var i=s%4;s-=i;for(var n=e.create(),o=0;s>o;o+=4)n.words.push(t.words.shift()),t.sigBytes-=4,n.sigBytes+=4;return i>0&&(n.words.push(t.words[0]),n.sigBytes+=i,r.bitshift(t,8*i),t.sigBytes-=i),n},r.xor=function(t,r){for(var e=0;e<t.words.length;e++)t.words[e]^=r.words[e];return t},r.xorendWords=function(t,e){return r.leftmostWords(t,(t.sigBytes-e.sigBytes)/4).concat(r.xor(r.rightmostWords(t,e.sigBytes/4),e))},r.xorendBytes=function(t,e){return r.leftmostBytes(t,t.sigBytes-e.sigBytes).concat(r.xor(r.rightmostBytes(t,e.sigBytes),e))},r.bitand=function(t,r){for(var e=t.clone(),s=e.words,i=r.words,n=0;n<s.length;n++)s[n]&=i[n];return e},r.dbl=function(t){return r.bitshift(t,1),1===r.msb(t)&&r.xor(t,r.const_Rb),t},r.equals=function(t,r){if(!r||!r.words||t.sigBytes!==r.sigBytes)return!1;t.clamp(),r.clamp();for(var e=0;e<t.words.length;e++)if(t.words[e]!==r.words[e])return!1;return!0},r.msb=function(t){return t.words[0]>>>31}}(CryptoJS),function(t){function r(r,e){var n=i.createEncryptor(r,{iv:s.create(),padding:t.pad.NoPadding}),o=n.finalize(e);return o}var e=t.lib.Base,s=t.lib.WordArray,i=t.algo.AES,n=t.ext,o=t.pad.OneZeroPadding;t.algo.CMAC=e.extend({init:function(t){var e=(s.create([2399141888,3976200192]),r(t,n.const_Zero)),i=e.clone();n.bitshift(i,1),1===n.msb(e)&&n.xor(i,n.const_Rb);var o=i.clone();n.bitshift(o,1),1===n.msb(o)&&n.xor(o,n.const_Rb),this._K1=i,this._K2=o,this._K=t,this._const_Bsize=16,this.reset()},reset:function(){this._x=n.const_Zero.clone(),this._counter=0,this._buffer=s.create()},update:function(e){var s=this._buffer,i=this._const_Bsize;for("string"==typeof e&&(e=t.enc.Utf8.parse(e)),s.concat(e);s.sigBytes>i;){var o=n.shift(s,i);n.xor(this._x,o),this._x=r(this._K,this._x),this._counter++}return this},finalize:function(t){this.update(t);var e=this._buffer,s=this._const_Bsize,i=e.clone();return e.sigBytes===s?n.xor(i,this._K1):(o.pad(i,s/4),n.xor(i,this._K2)),n.xor(i,this._x),this.reset(),r(this._K,i)}})}(CryptoJS),function(t){{var r=t.lib.Base,e=t.lib.WordArray,s=(t.algo.AES,t.ext),i=t.pad.OneZeroPadding,n=t.algo.CMAC,o=t.algo.S2V=r.extend({init:function(t){this._blockSize=16,this.reset(t)},reset:function(t){this._buffer=e.create(),t?(this._cmacAD=n.create(t),this._cmacPT=n.create(t)):(this._cmacAD.reset(),this._cmacPT.reset()),this._d=this._cmacAD.finalize(s.const_Zero),this._empty=!0,this._ptStarted=!1},updateAAD:function(r){return this._ptStarted?this:r?("string"==typeof r&&(r=t.enc.Utf8.parse(r)),this._d=s.xor(s.dbl(this._d),this._cmacAD.finalize(r)),this._empty=!1,this):this},update:function(r){if(!r)return this;this._ptStarted=!0;var e=this._buffer,i=this._blockSize,n=i/4,o=this._cmacPT;for("string"==typeof r&&(r=t.enc.Utf8.parse(r)),e.concat(r);e.sigBytes>=2*i;){this._empty=!1;var a=s.popWords(e,n);o.update(a)}return this},finalize:function(t){this.update(t);var r=this._blockSize,e=this._buffer;if(this._empty&&0===e.sigBytes)return this._cmacAD.finalize(s.const_One);var n;return e.sigBytes>=r?n=s.xorendWords(e,this._d):(i.pad(e,r),n=s.xor(s.dbl(this._d),e)),this._cmacPT.finalize(n)}});t.SIV=r.extend({init:function(t){var r=t.sigBytes/2;this._s2vKey=s.shiftBytes(t,r),this._ctrKey=t},encrypt:function(r,e){!e&&r&&(e=r,r=[]);var i=o.create(this._s2vKey);Array.prototype.forEach.call(r,function(t){i.updateAAD(t)});var n=i.finalize(e),a=s.bitand(n,s.const_nonMSB),c=t.AES.encrypt(e,this._ctrKey,{iv:a,mode:t.mode.CTR,padding:t.pad.NoPadding});return n.concat(c.ciphertext)},decrypt:function(r,e){!e&&r&&(e=r,r=[]);var i=s.shift(e,16),n=s.bitand(i,s.const_nonMSB),a=t.AES.decrypt({ciphertext:e},this._ctrKey,{iv:n,mode:t.mode.CTR,padding:t.pad.NoPadding}),c=o.create(this._s2vKey);Array.prototype.forEach.call(r,function(t){c.updateAAD(t)});var f=c.finalize(a);return s.equals(i,f)?a:!1}})}}(CryptoJS);