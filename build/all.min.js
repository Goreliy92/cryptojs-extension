/*
 * The MIT License
 *
 * (MIT)Copyright (c) 2015 artjomb
 */
!function(t){t.enc.Bin={stringify:function(t){for(var e=t.words,r=t.sigBytes,i=[],s=0;r>s;s++)for(var n=e[s>>>2]>>>24-s%4*8&255,o=7;o>=0;o--)i.push((n>>>o&1).toString(2));return i.join("")},parse:function(e){for(var r=[0],i=31,s=0,n=0;n<e.length;n++){var o=e[n];("0"===o||"1"===o)&&(r[r.length-1]+=parseInt(o)<<i,i--,s++,0>i&&(i=31,r.push(0)))}return t.lib.WordArray.create(r,Math.ceil(s/8))}}}(CryptoJS),function(t){var e;e=t.hasOwnProperty("ext")?t.ext:t.ext={},e.bitshift=function(t,e){var r,i,s=0,n=t.words,o=0;if(e>0){for(;e>31;)n.splice(0,1),n.push(0),e-=32,o++;if(0==e)return s;for(var c=n.length-o-1;c>=0;c--)r=n[c],n[c]<<=e,n[c]|=s,s=r>>>32-e}else if(0>e){for(;-31>e;)n.splice(0,0,0),n.length--,e+=32,o++;if(0==e)return s;e=-e,i=(1<<e)-1;for(var c=o;c<n.length;c++)r=n[c]&i,n[c]>>>=e,n[c]|=s,s=r<<32-e}return s},e.neg=function(t){for(var e=t.words,r=0;r<e.length;r++)e[r]=~e[r];return t},e.xor=function(t,e){for(var r=0;r<t.words.length;r++)t.words[r]^=e.words[r];return t},e.bitand=function(t,e){for(var r=t.clone(),i=r.words,s=e.words,n=0;n<i.length;n++)i[n]&=s[n];return r}}(CryptoJS),CryptoJS.mode.CFBw=function(){function t(t,e,r){for(var i=this,s=i._cipher,n=s.blockSize,o=i._prevBlock,c=s.cfg.segmentSize/32,a=0;n/c>a;a++){o?o=o.slice(c).concat(i._ct):(o=i._iv.slice(0),i._iv=void 0),r||(i._ct=t.slice(e+a*c,e+a*c+c));var f=o.slice(0);s.encryptBlock(f,0);for(var h=0;c>h;h++)t[e+a*c+h]^=f[h];r&&(i._ct=t.slice(e+a*c,e+a*c+c))}i._prevBlock=o}var e=CryptoJS.lib.BlockCipherMode.extend();return e.Encryptor=e.extend({processBlock:function(e,r){t.call(this,e,r,!0)}}),e.Decryptor=e.extend({processBlock:function(e,r){t.call(this,e,r,!1)}}),e}(),function(t){var e;e=t.hasOwnProperty("ext")?t.ext:t.ext={};{var r=(t.lib.Base,t.lib.WordArray);t.algo.AES}e.const_Zero=r.create([0,0,0,0]),e.const_One=r.create([0,0,0,1]),e.const_Rb=r.create([0,0,0,135]),e.const_nonMSB=r.create([4294967295,4294967295,2147483647,2147483647]),e.isWordArray=function(t){return t&&"function"==typeof t.clamp&&"function"==typeof t.concat&&"array"==typeof t.words},t.pad.OneZeroPadding={pad:function(t,e){for(var i=4*e,s=i-t.sigBytes%i,n=[],o=0;s>o;o+=4){var c=0;0===o&&(c=2147483648),n.push(c)}var a=r.create(n,s);t.concat(a)},unpad:function(){}},t.pad.NoPadding={pad:function(){},unpad:function(){}},e.leftmostBytes=function(t,e){var r=t.clone();return r.sigBytes=e,r.clamp(),r},e.rightmostBytes=function(t,r){t.clamp();var i=32,s=t.clone(),n=8*(s.sigBytes-r);if(n>=i){var o=Math.floor(n/i);n-=o*i,s.words.splice(0,o),s.sigBytes-=o*i/8}return n>0&&(e.bitshift(s,n),s.sigBytes-=n/8),s},e.popWords=function(t,r){var i=e.leftmostBytes(t,4*r);return t.words=t.words.slice(r),t.sigBytes-=4*r,i},e.shiftBytes=function(t,i){i=i||16;var s=i%4;i-=s;for(var n=r.create(),o=0;i>o;o+=4)n.words.push(t.words.shift()),t.sigBytes-=4,n.sigBytes+=4;return s>0&&(n.words.push(t.words[0]),n.sigBytes+=s,e.bitshift(t,8*s),t.sigBytes-=s),n},e.xorendBytes=function(t,r){return e.leftmostBytes(t,t.sigBytes-r.sigBytes).concat(e.xor(e.rightmostBytes(t,r.sigBytes),r))},e.dbl=function(t){var r=e.msb(t);return e.bitshift(t,1),1===r&&e.xor(t,e.const_Rb),t},e.equals=function(t,e){if(!e||!e.words||t.sigBytes!==e.sigBytes)return!1;t.clamp(),e.clamp();for(var r=0;r<t.words.length;r++)if(t.words[r]!==e.words[r])return!1;return!0},e.msb=function(t){return t.words[0]>>>31}}(CryptoJS),CryptoJS.mode.CFBb=function(){function t(t,e,n){var o,c,a,f=this,h=f._cipher,p=32*h.blockSize,u=f._prevBlock,d=h.cfg.segmentSize,l=[];for(o=31;d>o;o+=32)l.push(4294967295);for(l.push((1<<d)-1<<32-d),o=l.length;o<t.length;o++)l.push(0);l=r.create(l);var y,_=l.clone(),g=_.clone();for(i(g,32*-e),o=0;p/d>o;o++){if(u){for(u=r.create(u),i(u,d),u=u.words,previousCiphertextSegment=f._ct;previousCiphertextSegment.length<p/32;)previousCiphertextSegment.push(0);previousCiphertextSegment=r.create(previousCiphertextSegment),i(previousCiphertextSegment,-p+d);for(var c=0;c<u.length;c++)u[c]|=previousCiphertextSegment.words[c]}else u=f._iv.slice(0),f._iv=void 0;a=32*e+o*d;var v=r.create(t.slice(0));i(v,a),n||(f._ct=v.words.slice(0,Math.ceil(d/32)));var B=u.slice(0);for(h.encryptBlock(B,0),c=0;c<Math.ceil(d/32);c++)v.words[c]^=B[c];for(c=0;c<v.words.length;c++)v.words[c]&=l.words[c];for(n&&(f._ct=v.words.slice(0,Math.ceil(d/32))),y=s(g.clone()),c=0;c<t.length;c++)t[c]&=y.words[c];for(i(v,-a),c=0;c<t.length;c++)t[c]|=v.words[c];i(_,-d),i(g,-d)}f._prevBlock=u}var e=CryptoJS.lib.BlockCipherMode.extend(),r=CryptoJS.lib.WordArray,i=CryptoJS.ext.bitshift,s=CryptoJS.ext.neg;return e.Encryptor=e.extend({processBlock:function(e,r){t.call(this,e,r,!0)}}),e.Decryptor=e.extend({processBlock:function(e,r){t.call(this,e,r,!1)}}),e}(),function(t){function e(e,r){var n=s.createEncryptor(e,{iv:i.create(),padding:t.pad.NoPadding}),o=n.finalize(r);return o}var r=t.lib.Base,i=t.lib.WordArray,s=t.algo.AES,n=t.ext,o=t.pad.OneZeroPadding,c=t.algo.CMAC=r.extend({init:function(t){var r=e(t,n.const_Zero),i=r.clone();n.bitshift(i,1),1===n.msb(r)&&n.xor(i,n.const_Rb);var s=i.clone();n.bitshift(s,1),1===n.msb(i)&&n.xor(s,n.const_Rb),this._K1=i,this._K2=s,this._K=t,this._const_Bsize=16,this.reset()},reset:function(){this._x=n.const_Zero.clone(),this._counter=0,this._buffer=i.create()},update:function(r){if(!r)return this;var i=this._buffer,s=this._const_Bsize;for("string"==typeof r&&(r=t.enc.Utf8.parse(r)),i.concat(r);i.sigBytes>s;){var o=n.shiftBytes(i,s);n.xor(this._x,o),this._x.clamp(),this._x=e(this._K,this._x),this._counter++}return this},finalize:function(t){this.update(t);var r=this._buffer,i=this._const_Bsize,s=r.clone();return r.sigBytes===i?n.xor(s,this._K1):(o.pad(s,i/4),n.xor(s,this._K2)),n.xor(s,this._x),this.reset(),e(this._K,s)}});t.CMAC=function(t,e){return c.create(t).finalize(e)}}(CryptoJS),function(t){{var e=t.lib.Base,r=t.lib.WordArray,i=(t.algo.AES,t.ext),s=t.pad.OneZeroPadding,n=t.algo.CMAC,o=t.algo.S2V=e.extend({init:function(t){this._blockSize=16,this._cmacAD=n.create(t),this._cmacPT=n.create(t),this.reset()},reset:function(){this._buffer=r.create(),this._cmacAD.reset(),this._cmacPT.reset(),this._d=this._cmacAD.finalize(i.const_Zero),this._empty=!0,this._ptStarted=!1},updateAAD:function(e){return this._ptStarted?this:e?("string"==typeof e&&(e=t.enc.Utf8.parse(e)),this._d=i.xor(i.dbl(this._d),this._cmacAD.finalize(e)),this._empty=!1,this):this},update:function(e){if(!e)return this;this._ptStarted=!0;var r=this._buffer,s=this._blockSize,n=s/4,o=this._cmacPT;for("string"==typeof e&&(e=t.enc.Utf8.parse(e)),r.concat(e);r.sigBytes>=2*s;){this._empty=!1;var c=i.popWords(r,n);o.update(c)}return this},finalize:function(t){this.update(t);var e=this._blockSize,r=this._buffer;if(this._empty&&0===r.sigBytes)return this._cmacAD.finalize(i.const_One);var n;return r.sigBytes>=e?n=i.xorendBytes(r,this._d):(s.pad(r,e),n=i.xor(i.dbl(this._d),r)),this._cmacPT.finalize(n)}});t.SIV=e.extend({init:function(t){var e=t.sigBytes/2;this._s2vKey=i.shiftBytes(t,e),this._ctrKey=t},encrypt:function(e,r){!r&&e&&(r=e,e=[]);var s=o.create(this._s2vKey);Array.prototype.forEach.call(e,function(t){s.updateAAD(t)});var n=s.finalize(r),c=i.bitand(n,i.const_nonMSB),a=t.AES.encrypt(r,this._ctrKey,{iv:c,mode:t.mode.CTR,padding:t.pad.NoPadding});return n.concat(a.ciphertext)},decrypt:function(e,r){!r&&e&&(r=e,e=[]);var s=i.shiftBytes(r,16),n=i.bitand(s,i.const_nonMSB),c=t.AES.decrypt({ciphertext:r},this._ctrKey,{iv:n,mode:t.mode.CTR,padding:t.pad.NoPadding}),a=o.create(this._s2vKey);Array.prototype.forEach.call(e,function(t){a.updateAAD(t)});var f=a.finalize(c);return i.equals(s,f)?c:!1}})}}(CryptoJS);