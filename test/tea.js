var fs = require("fs");

var aesContent = fs.readFileSync("../lib/cryptojs-aes.min.js", "utf8");
var ecbContent = fs.readFileSync("../lib/cryptojs-mode-ecb.js", "utf8");
var teaContent = fs.readFileSync("../src/tea.js", "utf8");

var stats = { passed: 0, failed: 0 };

(function(){
	eval(aesContent);
	eval(ecbContent);
	eval(teaContent);
	
	var testcases = [
		{ key: "00000000000000000000000000000000", pt: "0000000000000000", ct:"41EA3A0A94BAA940"},
		{ key: "0000000094BAA94041EA3A0A00000000", pt: "41EA3A0A94BAA940", ct:"2030830DAA7D6D45"},
		{ key: "AA7D6D4594BAA94041EA3A0A2030830D", pt: "2030830DAA7D6D45", ct:"B58092E8CB06B5A5"},
		{ key: "AA7D6D455FBC1CE5F46AA8E22030830D", pt: "B58092E8CB06B5A5", ct:"B7AA21BADE4392A0"},
		{ key: "743EFFE55FBC1CE5F46AA8E2979AA2B7", pt: "B7AA21BADE4392A0", ct:"D9E28852535C1E30"},
		{ key: "743EFFE50CE002D52D8820B0979AA2B7", pt: "D9E28852535C1E30", ct:"BB8AF974E4ACD957"},
		{ key: "909226B20CE002D52D8820B02C105BC3", pt: "BB8AF974E4ACD957", ct:"0D099DA417937882"},
		{ key: "909226B21B737A572081BD142C105BC3", pt: "0D099DA417937882", ct:"5487B6E871EB4D0D"},
		{ key: "E1796BBF1B737A572081BD147897ED2B", pt: "5487B6E871EB4D0D", ct:"830A392A0E9B4803"},
		{ key: "E1796BBF15E83254A38B843E7897ED2B", pt: "830A392A0E9B4803", ct:"3A129BD454CDCEF3"},
		{ key: "B5B4A54C15E83254A38B843E428576FF", pt: "3A129BD454CDCEF3", ct:"781432E94DA8CE3D"},
		{ key: "B5B4A54C5840FC69DB9FB6D7428576FF", pt: "781432E94DA8CE3D", ct:"D7C1AF0306797E67"},
		{ key: "B3CDDB2B5840FC69DB9FB6D79544D9FC", pt: "D7C1AF0306797E67", ct:"42E9DD867F69466D"},
		{ key: "B3CDDB2B2729BA0499766B519544D9FC", pt: "42E9DD867F69466D", ct:"62AEE01FBD5AC206"},
		{ key: "0E97192D2729BA0499766B51F7EA39E3", pt: "62AEE01FBD5AC206", ct:"8E65E82A08F68B22"},
		{ key: "0E97192D2FDF31261713837BF7EA39E3", pt: "8E65E82A08F68B22", ct:"F4774C36874D8E6E"},
		{ key: "89DA97432FDF31261713837B039D75D5", pt: "F4774C36874D8E6E", ct:"CC768118AEA06739"},
		{ key: "89DA9743817F561FDB650263039D75D5", pt: "CC768118AEA06739", ct:"BBC88F18B395A46D"},
		{ key: "3A4F332E817F561FDB650263B855FACD", pt: "BBC88F18B395A46D", ct:"7AC046217844A2AD"},
		{ key: "3A4F332EF93BF4B2A1A54442B855FACD", pt: "7AC046217844A2AD", ct:"656535F85EC8A072"},
		{ key: "6487935CF93BF4B2A1A54442DD30CF35", pt: "656535F85EC8A072", ct:"C21E07C890DE0BA5"},
		{ key: "6487935C69E5FF1763BB438ADD30CF35", pt: "C21E07C890DE0BA5", ct:"2E1958972B5E8209"},
		{ key: "4FD9115569E5FF1763BB438AF32997A2", pt: "2E1958972B5E8209", ct:"0B113B2F1ADF9C80"},
		{ key: "4FD91155733A639768AA78A5F32997A2", pt: "0B113B2F1ADF9C80", ct:"E0006CA3985DF678"},
		{ key: "D784E72D733A639768AA78A51329FB01", pt: "E0006CA3985DF678", ct:"02345F5572AE441E"},
		{ key: "D784E72D019427896A9E27F01329FB01", pt: "02345F5572AE441E", ct:"4FEC7D6C3A6A4BCB"},
		{ key: "EDEEACE6019427896A9E27F05CC5866D", pt: "4FEC7D6C3A6A4BCB", ct:"A17A8F88083B108A"},
		{ key: "EDEEACE609AF3703CBE4A8785CC5866D", pt: "A17A8F88083B108A", ct:"2C331276A5E02D0B"},
		{ key: "480E81ED09AF3703CBE4A87870F6941B", pt: "2C331276A5E02D0B", ct:"C5CB8D58D7A42140"},
		{ key: "480E81EDDE0B16430E2F252070F6941B", pt: "C5CB8D58D7A42140", ct:"5991EFDEE9B5B20D"},
		{ key: "A1BB33E0DE0B16430E2F252029677BC5", pt: "5991EFDEE9B5B20D", ct:"59A8C4A13A5139EA"},
		{ key: "A1BB33E0E45A2FA95787E18129677BC5", pt: "59A8C4A13A5139EA", ct:"41A00B3F1D397C9F"},
		{ key: "BC824F7FE45A2FA95787E18168C770FA", pt: "41A00B3F1D397C9F", ct:"6ECE9A156671902E"},
		{ key: "BC824F7F822BBF8739497B9468C770FA", pt: "6ECE9A156671902E", ct:"03B9D491DD0AED1F"},
		{ key: "6188A260822BBF8739497B946B7EA46B", pt: "03B9D491DD0AED1F", ct:"8E92339332DA8723"},
		{ key: "6188A260B0F138A4B7DB48076B7EA46B", pt: "8E92339332DA8723", ct:"B79079C98E2A231F"},
		{ key: "EFA2817FB0F138A4B7DB4807DCEEDDA2", pt: "B79079C98E2A231F", ct:"60F296FF70E7A99E"},
		{ key: "EFA2817FC016913AD729DEF8DCEEDDA2", pt: "60F296FF70E7A99E", ct:"3D32E45FA2258E03"},
		{ key: "4D870F7CC016913AD729DEF8E1DC39FD", pt: "3D32E45FA2258E03", ct:"18BF449CEDFDBE1E"},
		{ key: "4D870F7C2DEB2F24CF969A64E1DC39FD", pt: "18BF449CEDFDBE1E", ct:"F728D28AD6107609"},
		{ key: "9B9779752DEB2F24CF969A6416F4EB77", pt: "F728D28AD6107609", ct:"4B1975CA66C24E2F"},
		{ key: "9B9779754B29610B848FEFAE16F4EB77", pt: "4B1975CA66C24E2F", ct:"0E0BE20BC4BA79FA"},
		{ key: "5F2D008F4B29610B848FEFAE18FF097C", pt: "0E0BE20BC4BA79FA", ct:"36C569EC96C10A2E"},
		{ key: "5F2D008FDDE86B25B24A864218FF097C", pt: "36C569EC96C10A2E", ct:"B10C073257989F5C"},
		{ key: "08B59FD3DDE86B25B24A8642A9F30E4E", pt: "B10C073257989F5C", ct:"C85337EC38F786C0"},
		{ key: "08B59FD3E51FEDE57A19B1AEA9F30E4E", pt: "C85337EC38F786C0", ct:"623FCE34069C83F6"},
		{ key: "0E291C25E51FEDE57A19B1AECBCCC07A", pt: "623FCE34069C83F6", ct:"631043911F59484D"},
		{ key: "0E291C25FA46A5A81909F23FCBCCC07A", pt: "631043911F59484D", ct:"AF1081C9302FEB15"},
		{ key: "3E06F730FA46A5A81909F23F64DC41B3", pt: "AF1081C9302FEB15", ct:"75C4BB5406097771"},
		{ key: "3E06F730FC4FD2D96CCD496B64DC41B3", pt: "75C4BB5406097771", ct:"0E5207C3A6F539A2"},
		{ key: "98F3CE92FC4FD2D96CCD496B6A8E4670", pt: "0E5207C3A6F539A2", ct:"2CD008AF24E175C7"},
		{ key: "98F3CE92D8AEA71E401D41C46A8E4670", pt: "2CD008AF24E175C7", ct:"D469048B8C5007C6"},
		{ key: "14A3C954D8AEA71E401D41C4BEE742FB", pt: "D469048B8C5007C6", ct:"FCD76F8E34D22871"},
		{ key: "14A3C954EC7C8F6FBCCA2E4ABEE742FB", pt: "FCD76F8E34D22871", ct:"41F85A6CD42951DB"},
		{ key: "C08A988FEC7C8F6FBCCA2E4AFF1F1897", pt: "41F85A6CD42951DB", ct:"DF75E6EE9CC492A5"},
		{ key: "C08A988F70B81DCA63BFC8A4FF1F1897", pt: "DF75E6EE9CC492A5", ct:"A27F6ACEA7955433"},
		{ key: "671FCCBC70B81DCA63BFC8A45D607259", pt: "A27F6ACEA7955433", ct:"E1454CF83476DB92"},
		{ key: "671FCCBC44CEC65882FA845C5D607259", pt: "E1454CF83476DB92", ct:"2EDE238C870AA382"},
		{ key: "E0156F3E44CEC65882FA845C73BE51D5", pt: "2EDE238C870AA382", ct:"F54246958C00C3BF"},
		{ key: "E0156F3EC8CE05E777B8C2C973BE51D5", pt: "F54246958C00C3BF", ct:"0670F8679BC8FAE2"},
		{ key: "7BDD95DCC8CE05E777B8C2C975CEA9B2", pt: "0670F8679BC8FAE2", ct:"B5FC91E4122DE829"},
		{ key: "7BDD95DCDAE3EDCEC244532D75CEA9B2", pt: "B5FC91E4122DE829", ct:"C981A368D7F04E41"},
		{ key: "AC2DDB9DDAE3EDCEC244532DBC4F0ADA", pt: "C981A368D7F04E41", ct:"9CA11ECB344F54B0"},
		{ key: "AC2DDB9DEEACB97E5EE54DE6BC4F0ADA", pt: "9CA11ECB344F54B0", ct:"815BA6C034D015DD"},
		{ key: "98FDCE40EEACB97E5EE54DE63D14AC1A", pt: "815BA6C034D015DD", ct:"58A343381C05429D"},
		{ key: "98FDCE40F2A9FBE306460EDE3D14AC1A", pt: "58A343381C05429D", ct:"8F58E0186CBD680C"},
		{ key: "F440A64CF2A9FBE306460EDEB24C4C02", pt: "8F58E0186CBD680C", ct:"B551A27DEEAE4156"},
		{ key: "F440A64C1C07BAB5B317ACA3B24C4C02", pt: "B551A27DEEAE4156", ct:"D15768AD4E0F7B4F"},
		{ key: "BA4FDD031C07BAB5B317ACA3631B24AF", pt: "D15768AD4E0F7B4F", ct:"CEE747EA6B002FDC"},
		{ key: "BA4FDD03770795697DF0EB49631B24AF", pt: "CEE747EA6B002FDC", ct:"3AC4C4F82D8266BA"},
		{ key: "97CDBBB9770795697DF0EB4959DFE057", pt: "3AC4C4F82D8266BA", ct:"303CD14516368E55"},
		{ key: "97CDBBB961311B3C4DCC3A0C59DFE057", pt: "303CD14516368E55", ct:"554443FDC5B07DBA"},
		{ key: "527DC60361311B3C4DCC3A0C0C9BA3AA", pt: "554443FDC5B07DBA", ct:"7D4EEFAA76BB47A4"},
		{ key: "527DC603178A5C983082D5A60C9BA3AA", pt: "7D4EEFAA76BB47A4", ct:"C015402881BE0844"},
		{ key: "D3C3CE47178A5C983082D5A6CC8EE382", pt: "C015402881BE0844", ct:"E8E1388613E3FE4E"},
		{ key: "D3C3CE470469A2D6D863ED20CC8EE382", pt: "E8E1388613E3FE4E", ct:"FCFACE18E85F91FB"},
		{ key: "3B9C5FBC0469A2D6D863ED2030742D9A", pt: "FCFACE18E85F91FB", ct:"99FC41875BA19BF1"},
		{ key: "3B9C5FBC5FC83927419FACA730742D9A", pt: "99FC41875BA19BF1", ct:"6868C5C043E660B0"},
		{ key: "787A3F0C5FC83927419FACA7581CE85A", pt: "6868C5C043E660B0", ct:"600B9A14896A12D7"},
		{ key: "787A3F0CD6A22BF0219436B3581CE85A", pt: "600B9A14896A12D7", ct:"C6D1CDD0B674BB9E"},
		{ key: "CE0E8492D6A22BF0219436B39ECD258A", pt: "C6D1CDD0B674BB9E", ct:"7FCD185580F8BB4B"},
		{ key: "CE0E8492565A90BB5E592EE69ECD258A", pt: "7FCD185580F8BB4B", ct:"8279AD3D7089755E"},
		{ key: "BE87F1CC565A90BB5E592EE61CB488B7", pt: "8279AD3D7089755E", ct:"CA52C3075B0CC89B"},
		{ key: "BE87F1CC0D565820940BEDE11CB488B7", pt: "CA52C3075B0CC89B", ct:"FBA81D00BA59FD4F"},
		{ key: "04DE0C830D565820940BEDE1E71C95B7", pt: "FBA81D00BA59FD4F", ct:"FB861C919BD81C95"},
		{ key: "04DE0C83968E44B56F8DF170E71C95B7", pt: "FB861C919BD81C95", ct:"92B872CF95B0572D"},
		{ key: "916E5BAE968E44B56F8DF17075A4E778", pt: "92B872CF95B0572D", ct:"1FE51C21E4F9140A"},
		{ key: "916E5BAE727750BF7068ED5175A4E778", pt: "1FE51C21E4F9140A", ct:"80A9FFB1118FA1F7"},
		{ key: "80E1FA59727750BF7068ED51F50D18C9", pt: "80A9FFB1118FA1F7", ct:"4366A93E2ED91DB2"},
		{ key: "80E1FA595CAE4D0D330E446FF50D18C9", pt: "4366A93E2ED91DB2", ct:"7772428E9683EF07"},
		{ key: "1662155E5CAE4D0D330E446F827F5A47", pt: "7772428E9683EF07", ct:"742A965D80DB3FE4"},
		{ key: "1662155EDC7572E94724D232827F5A47", pt: "742A965D80DB3FE4", ct:"46D7A89009024931"},
		{ key: "1F605C6FDC7572E94724D232C4A8F2D7", pt: "46D7A89009024931", ct:"822528D60248656D"},
		{ key: "1F605C6FDE3D1784C501FAE4C4A8F2D7", pt: "822528D60248656D", ct:"124A0D3C5B53214E"},
		{ key: "44337D21DE3D1784C501FAE4D6E2FFEB", pt: "124A0D3C5B53214E", ct:"2703BB08C50E1BC0"},
		{ key: "44337D211B330C44E20241ECD6E2FFEB", pt: "2703BB08C50E1BC0", ct:"19C8DD1AF291525E"},
		{ key: "B6A22F7F1B330C44E20241ECCF2A22F1", pt: "19C8DD1AF291525E", ct:"BBB04538161ED5D5"},
		{ key: "B6A22F7F0D2DD99159B204D4CF2A22F1", pt: "BBB04538161ED5D5", ct:"DD670945F87D6F8A"},
		{ key: "4EDF40F50D2DD99159B204D4124D2BB4", pt: "DD670945F87D6F8A", ct:"BAE95EB7A1725643"},
		{ key: "4EDF40F5AC5F8FD2E35B5A63124D2BB4", pt: "BAE95EB7A1725643", ct:"4A7030BCE2FEBD61"},
	];

	var testcasesX = [
		{key: "00000000000000000000000000000000", pt: "0000000000000000", ct: "DEE9D4D8F7131ED9"},
		{key: "00000000F7131ED9DEE9D4D800000000", pt: "DEE9D4D8F7131ED9", ct: "3CC8694E8CBF97B1"},
		{key: "8CBF97B1F7131ED9DEE9D4D83CC8694E", pt: "3CC8694E8CBF97B1", ct: "52A85E6B0CDE00F9"},
		{key: "8CBF97B1FBCD1E208C418AB33CC8694E", pt: "52A85E6B0CDE00F9", ct: "BEC8BFF15DC896F1"},
		{key: "D1770140FBCD1E208C418AB38200D6BF", pt: "BEC8BFF15DC896F1", ct: "A4AAD0C2D0F27ACD"},
		{key: "D17701402B3F64ED28EB5A718200D6BF", pt: "A4AAD0C2D0F27ACD", ct: "E57ACB6CB10DB7B7"},
		{key: "607AB6F72B3F64ED28EB5A71677A1DD3", pt: "E57ACB6CB10DB7B7", ct: "64535EB7E442E910"},
		{key: "607AB6F7CF7D8DFD4CB804C6677A1DD3", pt: "64535EB7E442E910", ct: "74606E50E6864651"},
		{key: "86FCF0A6CF7D8DFD4CB804C6131A7383", pt: "74606E50E6864651", ct: "F4386F191157D399"},
		{key: "86FCF0A6DE2A5E64B8806BDF131A7383", pt: "F4386F191157D399", ct: "5CB7402DE3B92580"},
		{key: "6545D526DE2A5E64B8806BDF4FAD33AE", pt: "5CB7402DE3B92580", ct: "0178620A110B0F94"},
		{key: "6545D526CF2151F0B9F809D54FAD33AE", pt: "0178620A110B0F94", ct: "CB6929A12B65EB5D"},
		{key: "4E203E7BCF2151F0B9F809D584C41A0F", pt: "CB6929A12B65EB5D", ct: "29D616E60172AB36"},
		{key: "4E203E7BCE53FAC6902E1F3384C41A0F", pt: "29D616E60172AB36", ct: "44D536A18A0A77C3"},
		{key: "C42A49B8CE53FAC6902E1F33C0112CAE", pt: "44D536A18A0A77C3", ct: "3288754DAFDFAC7A"},
		{key: "C42A49B8618C56BCA2A66A7EC0112CAE", pt: "3288754DAFDFAC7A", ct: "1AF34BCCAD18BD83"},
		{key: "6932F43B618C56BCA2A66A7EDAE26762", pt: "1AF34BCCAD18BD83", ct: "78309FCCB46BE744"},
		{key: "6932F43BD5E7B1F8DA96F5B2DAE26762", pt: "78309FCCB46BE744", ct: "4F42AEA1B1A9A522"},
		{key: "D89B5119D5E7B1F8DA96F5B295A0C9C3", pt: "4F42AEA1B1A9A522", ct: "5342248E5E3E3082"},
		{key: "D89B51198BD9817A89D4D13C95A0C9C3", pt: "5342248E5E3E3082", ct: "CE29E786FB2350F2"},
		{key: "23B801EB8BD9817A89D4D13C5B892E45", pt: "CE29E786FB2350F2", ct: "6A525B4ECEF1526B"},
		{key: "23B801EB4528D311E3868A725B892E45", pt: "6A525B4ECEF1526B", ct: "9DA69CF0B4BA1F55"},
		{key: "97021EBE4528D311E3868A72C62FB2B5", pt: "9DA69CF0B4BA1F55", ct: "3D9A3BF4C280168C"},
		{key: "97021EBE87A8C59DDE1CB186C62FB2B5", pt: "3D9A3BF4C280168C", ct: "3978AB4A6C36713D"},
		{key: "FB346F8387A8C59DDE1CB186FF5719FF", pt: "3978AB4A6C36713D", ct: "56FD8861D124D797"},
		{key: "FB346F83568C120A88E139E7FF5719FF", pt: "56FD8861D124D797", ct: "848E74C32D5683BC"},
		{key: "D662EC3F568C120A88E139E77BD96D3C", pt: "848E74C32D5683BC", ct: "A30B232E6BE09755"},
		{key: "D662EC3F3D6C855F2BEA1AC97BD96D3C", pt: "A30B232E6BE09755", ct: "AFC0FD6F63B30C04"},
		{key: "B5D1E03B3D6C855F2BEA1AC9D4199053", pt: "AFC0FD6F63B30C04", ct: "E2CDA78E72023491"},
		{key: "B5D1E03B4F6EB1CEC927BD47D4199053", pt: "E2CDA78E72023491", ct: "D29D96F181524058"},
		{key: "3483A0634F6EB1CEC927BD47068406A2", pt: "D29D96F181524058", ct: "630B084EACD155D4"},
		{key: "3483A063E3BFE41AAA2CB509068406A2", pt: "630B084EACD155D4", ct: "A02E11AD1FC0A6FD"},
		{key: "2B43069EE3BFE41AAA2CB509A6AA170F", pt: "A02E11AD1FC0A6FD", ct: "CBCFBE4E30B99196"},
		{key: "2B43069ED306758C61E30B47A6AA170F", pt: "CBCFBE4E30B99196", ct: "D40F79772D469BEC"},
		{key: "06059D72D306758C61E30B4772A56E78", pt: "D40F79772D469BEC", ct: "F9318D5FEBA2F2D0"},
		{key: "06059D7238A4875C98D2861872A56E78", pt: "F9318D5FEBA2F2D0", ct: "1D8D77414E4BBDF9"},
		{key: "484E208B38A4875C98D286186F281939", pt: "1D8D77414E4BBDF9", ct: "DBFA9114A644D2B2"},
		{key: "484E208B9EE055EE4328170C6F281939", pt: "DBFA9114A644D2B2", ct: "2F716928EEDDCA0A"},
		{key: "A693EA819EE055EE4328170C40597011", pt: "2F716928EEDDCA0A", ct: "61991BAE71216BDD"},
		{key: "A693EA81EFC13E3322B10CA240597011", pt: "61991BAE71216BDD", ct: "1C690E783AB2EB31"},
		{key: "9C2101B0EFC13E3322B10CA25C307E69", pt: "1C690E783AB2EB31", ct: "41CF072839DBD85E"},
		{key: "9C2101B0D61AE66D637E0B8A5C307E69", pt: "41CF072839DBD85E", ct: "B39AD6B90229EA22"},
		{key: "9E08EB92D61AE66D637E0B8AEFAAA8D0", pt: "B39AD6B90229EA22", ct: "FDF35CDE7B86FAB4"},
		{key: "9E08EB92AD9C1CD99E8D5754EFAAA8D0", pt: "FDF35CDE7B86FAB4", ct: "C3A88A1ABC5E68DF"},
		{key: "2256834DAD9C1CD99E8D57542C0222CA", pt: "C3A88A1ABC5E68DF", ct: "60EDBD086EED0D85"},
		{key: "2256834DC371115CFE60EA5C2C0222CA", pt: "60EDBD086EED0D85", ct: "FF00AA9A1FF56278"},
		{key: "3DA3E135C371115CFE60EA5CD3028850", pt: "FF00AA9A1FF56278", ct: "5C06F2BF7C9228A5"},
		{key: "3DA3E135BFE339F9A26618E3D3028850", pt: "5C06F2BF7C9228A5", ct: "8EDC85A2E8612EBA"},
		{key: "D5C2CF8FBFE339F9A26618E35DDE0DF2", pt: "8EDC85A2E8612EBA", ct: "1349A559885D52AD"},
		{key: "D5C2CF8F37BE6B54B12FBDBA5DDE0DF2", pt: "1349A559885D52AD", ct: "FEBCF07E30CDBF94"},
		{key: "E50F701B37BE6B54B12FBDBAA362FD8C", pt: "FEBCF07E30CDBF94", ct: "A8C8B27FC084E8AC"},
		{key: "E50F701BF73A83F819E70FC5A362FD8C", pt: "A8C8B27FC084E8AC", ct: "24C64949D3CAE7BF"},
		{key: "36C597A4F73A83F819E70FC587A4B4C5", pt: "24C64949D3CAE7BF", ct: "80651D15DC8B276B"},
		{key: "36C597A42BB1A493998212D087A4B4C5", pt: "80651D15DC8B276B", ct: "FAA72821E7E94E1F"},
		{key: "D12CD9BB2BB1A493998212D07D039CE4", pt: "FAA72821E7E94E1F", ct: "3AB09A85D751AB0D"},
		{key: "D12CD9BBFCE00F9EA33288557D039CE4", pt: "3AB09A85D751AB0D", ct: "623764C84CC94541"},
		{key: "9DE59CFAFCE00F9EA33288551F34F82C", pt: "623764C84CC94541", ct: "6F56907F99DA4AC6"},
		{key: "9DE59CFA653A4558CC64182A1F34F82C", pt: "6F56907F99DA4AC6", ct: "09C7545700EEFA1F"},
		{key: "9D0B66E5653A4558CC64182A16F3AC7B", pt: "09C7545700EEFA1F", ct: "F81403487AA9307E"},
		{key: "9D0B66E51F93752634701B6216F3AC7B", pt: "F81403487AA9307E", ct: "CDE598DF7303BDF3"},
		{key: "EE08DB161F93752634701B62DB1634A4", pt: "CDE598DF7303BDF3", ct: "32DB54DB76A2AE8A"},
		{key: "EE08DB166931DBAC06AB4FB9DB1634A4", pt: "32DB54DB76A2AE8A", ct: "945EA663368DE0C2"},
		{key: "D8853BD46931DBAC06AB4FB94F4892C7", pt: "945EA663368DE0C2", ct: "A19AD33E7858A7B8"},
		{key: "D8853BD411697C14A7319C874F4892C7", pt: "A19AD33E7858A7B8", ct: "8BA91022955EC479"},
		{key: "4DDBFFAD11697C14A7319C87C4E182E5", pt: "8BA91022955EC479", ct: "579EE0F25D456C89"},
		{key: "4DDBFFAD4C2C109DF0AF7C75C4E182E5", pt: "579EE0F25D456C89", ct: "DCD90C49383898A8"},
		{key: "75E367054C2C109DF0AF7C7518388EAC", pt: "DCD90C49383898A8", ct: "C2D39D0818EA87BF"},
		{key: "75E3670554C69722327CE17D18388EAC", pt: "C2D39D0818EA87BF", ct: "C7C679780D90C08E"},
		{key: "7873A78B54C69722327CE17DDFFEF7D4", pt: "C7C679780D90C08E", ct: "E41B9A87AEDC0D36"},
		{key: "7873A78BFA1A9A14D6677BFADFFEF7D4", pt: "E41B9A87AEDC0D36", ct: "60DE5902DF1217BE"},
		{key: "A761B035FA1A9A14D6677BFABF20AED6", pt: "60DE5902DF1217BE", ct: "7B9FD1723F71A4E8"},
		{key: "A761B035C56B3EFCADF8AA88BF20AED6", pt: "7B9FD1723F71A4E8", ct: "FE57904CFB7B8608"},
		{key: "5C1A363DC56B3EFCADF8AA8841773E9A", pt: "FE57904CFB7B8608", ct: "CC2A32F657B06C99"},
		{key: "5C1A363D92DB526561D2987E41773E9A", pt: "CC2A32F657B06C99", ct: "C051C19639EC0E23"},
		{key: "65F6381E92DB526561D2987E8126FF0C", pt: "C051C19639EC0E23", ct: "29D53FF5B78D2AED"},
		{key: "65F6381E255678884807A78B8126FF0C", pt: "29D53FF5B78D2AED", ct: "A7BF72758F2A3440"},
		{key: "EADC0C5E255678884807A78B26998D79", pt: "A7BF72758F2A3440", ct: "70D77CBB155AD5A5"},
		{key: "EADC0C5E300CAD2D38D0DB3026998D79", pt: "70D77CBB155AD5A5", ct: "A2E5276D66566A99"},
		{key: "8C8A66C7300CAD2D38D0DB30847CAA14", pt: "A2E5276D66566A99", ct: "11111D217545C4C9"},
		{key: "8C8A66C7454969E429C1C611847CAA14", pt: "11111D217545C4C9", ct: "20B7ADC062FE7C2E"},
		{key: "EE741AE9454969E429C1C611A4CB07D4", pt: "20B7ADC062FE7C2E", ct: "78AA5308EB08A068"},
		{key: "EE741AE9AE41C98C516B9519A4CB07D4", pt: "78AA5308EB08A068", ct: "D058E231196EA1C4"},
		{key: "F71ABB2DAE41C98C516B95197493E5E5", pt: "D058E231196EA1C4", ct: "8D59A1AA3E39404D"},
		{key: "F71ABB2D907889C1DC3234B37493E5E5", pt: "8D59A1AA3E39404D", ct: "99ADEE591F9809D2"},
		{key: "E882B2FF907889C1DC3234B3ED3E0BBC", pt: "99ADEE591F9809D2", ct: "38B3A5701D9E2880"},
		{key: "E882B2FF8DE6A141E48191C3ED3E0BBC", pt: "38B3A5701D9E2880", ct: "60922C8730A3FDA6"},
		{key: "D8214F598DE6A141E48191C38DAC273B", pt: "60922C8730A3FDA6", ct: "2B3563EFEC2A1786"},
		{key: "D8214F5961CCB6C7CFB4F22C8DAC273B", pt: "2B3563EFEC2A1786", ct: "AAAFA9D554321370"},
		{key: "8C135C2961CCB6C7CFB4F22C27038EEE", pt: "AAAFA9D554321370", ct: "4E38C44927507BA6"},
		{key: "8C135C29469CCD61818C366527038EEE", pt: "4E38C44927507BA6", ct: "A2B4C0869F270EF2"},
		{key: "133452DB469CCD61818C366585B74E68", pt: "A2B4C0869F270EF2", ct: "50A4B87D911CE38B"},
		{key: "133452DBD7802EEAD1288E1885B74E68", pt: "50A4B87D911CE38B", ct: "CC43270246A55111"},
		{key: "559103CAD7802EEAD1288E1849F4696A", pt: "CC43270246A55111", ct: "76BD9D2BF5BD3039"},
		{key: "559103CA223D1ED3A795133349F4696A", pt: "76BD9D2BF5BD3039", ct: "8A5BC615F365DFF1"},
		{key: "A6F4DC3B223D1ED3A7951333C3AFAF7F", pt: "8A5BC615F365DFF1", ct: "D98F2B6F9BC27145"},
		{key: "A6F4DC3BB9FF6F967E1A385CC3AFAF7F", pt: "D98F2B6F9BC27145", ct: "6743AD54C83540FE"},
		{key: "6EC19CC5B9FF6F967E1A385CA4EC022B", pt: "6743AD54C83540FE", ct: "A05F932100D5A2C9"},
		{key: "6EC19CC5B92ACD5FDE45AB7DA4EC022B", pt: "A05F932100D5A2C9", ct: "0A50A8F8EB517864"},
		{key: "8590E4A1B92ACD5FDE45AB7DAEBCAAD3", pt: "0A50A8F8EB517864", ct: "0849B9866D136D19"},
		{key: "8590E4A1D439A046D60C12FBAEBCAAD3", pt: "0849B9866D136D19", ct: "A9FAF0D5FE97E94A"},
	];


	CryptoJS.pad.NoPadding = {
		pad: function () {},
		unpad: function () {}
	};

	function assert(got, expected, msg){
		var passed = got === expected;
		if (msg) {
			msg = " (" + msg + ")";
		} else {
			msg = "";
		}
		if (passed) {
			console.log("PASS got=" + got + msg);
			stats.passed++;
		} else {
			console.log("FAIL got=" + got + " expected=" + expected + msg);
			stats.failed++;
		}
	}
	
	function repeat(str, num)
	{
		return new Array(num + 1).join(str);
	}

	testcases.forEach(function(tc, i){
		// console.log("Testcase: " + i);
		var keyBytes = CryptoJS.enc.Hex.parse(tc.key);
		var ptBytes = CryptoJS.enc.Hex.parse(tc.pt);
		var ctBytes = CryptoJS.enc.Hex.parse(tc.ct);
		
		var ct = CryptoJS.TEA.encrypt(ptBytes, keyBytes, { mode: CryptoJS.mode.ECB, padding: CryptoJS.pad.NoPadding });
		assert(ct.ciphertext.toString(), tc.ct.toLowerCase(), "ct matches");
		
		var pt = CryptoJS.TEA.decrypt({ciphertext: ctBytes}, keyBytes, { mode: CryptoJS.mode.ECB, padding: CryptoJS.pad.NoPadding });
		assert(pt.toString(), tc.pt.toLowerCase(), "pt matches");
	});
	
	testcasesX.forEach(function(tc, i){
		// console.log("Testcase: " + i);
		var keyBytes = CryptoJS.enc.Hex.parse(tc.key);
		var ptBytes = CryptoJS.enc.Hex.parse(tc.pt);
		var ctBytes = CryptoJS.enc.Hex.parse(tc.ct);
		
		var ct = CryptoJS.XTEA.encrypt(ptBytes, keyBytes, { mode: CryptoJS.mode.ECB, padding: CryptoJS.pad.NoPadding });
		assert(ct.ciphertext.toString(), tc.ct.toLowerCase(), "ct matches");
		
		var pt = CryptoJS.XTEA.decrypt({ciphertext: ctBytes}, keyBytes, { mode: CryptoJS.mode.ECB, padding: CryptoJS.pad.NoPadding });
		assert(pt.toString(), tc.pt.toLowerCase(), "pt matches");
	});
})();

console.log("TEA/XTEA test - passed: " + stats.passed + ", failed: " + stats.failed + ", total: " + (stats.passed+stats.failed) + "\n");

if (stats.failed > 0) {
	process.exit(1);
}